<div class="page-header">
  <h1 class="page-title">Siparişler</h1>
</div>
<div class="toolbar">
  <label class="toolbar-field">
    <span class="toolbar-label">Başlangıç tarihi</span>
    <input [(ngModel)]="searchDateFrom" type="date" class="toolbar-input" />
  </label>
  <label class="toolbar-field">
    <span class="toolbar-label">Bitiş tarihi</span>
    <input [(ngModel)]="searchDateTo" type="date" class="toolbar-input" />
  </label>
  <label class="toolbar-field">
    <span class="toolbar-label">Durum</span>
    <select [(ngModel)]="searchStatus" class="toolbar-select">
      <option [ngValue]="null">Tümü</option>
      <option [ngValue]="0">Bekliyor</option>
      <option [ngValue]="1">Tamamı Teslim</option>
      <option [ngValue]="2">İptal</option>
      <option [ngValue]="3">Onaylandı</option>
      <option [ngValue]="4">Kısmi Teslim</option>
    </select>
  </label>
  <div class="toolbar-field toolbar-field-btn">
    <span class="toolbar-label">&nbsp;</span>
    <button type="button" (click)="load()">Filtrele</button>
  </div>
  <div class="toolbar-field toolbar-field-btn">
    <span class="toolbar-label">&nbsp;</span>
    <a routerLink="/orders/new" class="btn btn-primary">Yeni Sipariş</a>
  </div>
</div>
<div class="card table-wrap">
  <table>
    <thead>
      <tr>
        <th>Sipariş No</th>
        <th>Tarih</th>
        <th>Tip</th>
        <th>Cari</th>
        <th>Toplam</th>
        <th>Durum</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      @for (o of items; track o.id) {
        <tr>
          <td><strong>{{ o.orderNumber }}</strong></td>
          <td>{{ o.orderDate | date:'dd.MM.yyyy' }}</td>
          <td>{{ typeLabel(o.orderType) }}</td>
          <td>{{ o.customerTitle || '—' }}</td>
          <td>{{ o.totalAmount != null ? (o.totalAmount | number:'1.2-2') + ' ₺' : '—' }}</td>
          <td>{{ statusLabel(o.status) }}</td>
          <td>
            <div class="actions-cell">
              <a [routerLink]="['/orders', o.id]">Detay</a>
              @if (isEditableStatus(o)) {
                <a [routerLink]="['/orders', o.id, 'edit']">Düzenle</a>
              }
            </div>
          </td>
        </tr>
      }
    </tbody>
  </table>
</div>
<div class="pagination">
  <span>Toplam: {{ totalCount }} kayıt — Sayfa {{ page }}</span>
  <button type="button" [disabled]="page <= 1" (click)="prevPage()">Önceki</button>
  <button type="button" [disabled]="items.length < pageSize" (click)="nextPage()">Sonraki</button>
</div>
